machine:
  node:
    version:
      0.12.2
deployment:
  demo:
    branch: master
    commands:
      - bundle exec cap demo deploy
dependencies:
  pre:
    - sudo apt-get update
test:
  pre:
    - bundle exec rake bower:install
    - bundle exec rails s:
        background: true
    - npm install
    - npm run update-webdriver
    - npm run start-webdriver:
        background: true
    - sleep 5
  override:
    - bundle exec rspec --color --require spec_helper spec --format progress
    - bundle exec rubocop
    - bundle exec haml-lint app/views/
    - RAILS_ENV=test RACK_ENV=test bundle exec rake spec:javascript
    - bundle exec rake db:seed
    - npm run protractor
